<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>开发文档 - Bmob文档中心</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/custom.css" rel="stylesheet" id="custom">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script src="../../js/main.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-fixed-top" role="navigation">
    <div class="main-nav">
        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">
                <!--Bmob文档中心-->
                <img src="../../img/logo.png" alt="">
            </a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">

          <ul class="nav navbar-nav">
            
              <li class="pull-left">
                
					<a href="../..">文档首页</a>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">数据服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">数据服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../data/android/">Android SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/ios/">iOS SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/wechat_app/">小程序</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/cocos2d_x/">Cocos2D-X</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/csharp/">C# SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/go/">GO</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/javascript/">JavaScript</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/php/">PHP</a>
                                </li>
                            
                            
								<li >
									<a href="../../data/restful/">RESTful</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">云函数</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">云函数 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../cloud_function/android/">Android SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/ios/">iOS SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/java/">Java 云函数</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/javascript/">JavaScript</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/csharp/">C#</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/php/">PHP</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/restful/">RESTful</a>
                                </li>
                            
                            
								<li >
									<a href="../../cloud_function/web/">Web</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">支付服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">支付服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../pay/android/">Android SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../pay/ios/">iOS SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../pay/restful/">RESTful</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">短信服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">短信服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../sms/android/">Android SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../sms/ios/">iOS SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../sms/javascript/">JavaScript</a>
                                </li>
                            
                            
								<li >
									<a href="../../sms/php/">PHP</a>
                                </li>
                            
                            
								<li >
									<a href="../../sms/restful/">RESTful</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">IM服务</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">IM服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../im/android/">Android SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../../im/ios/">iOS SDK</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left active">
                
					<!--<a href="">推送服务</a>-->
					<li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">推送服务 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../android/">Android SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../ios/">iOS SDK</a>
                                </li>
                            
                            
								<li >
									<a href="../javascript/">JavaScript</a>
                                </li>
                            
                            
								<li class="active">
									<a href="./">PHP</a>
                                </li>
                            
                            
								<li >
									<a href="../restful/">RESTful</a>
                                </li>
                            
                        </ul>
                    </li>
                
              </li>
            
              <li class="pull-left">
                
					<!--<a href="">其他</a>-->
					<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">其他 <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
								<li >
									<a href="../../other/common_problem/">常见问题</a>
                                </li>
                            
                            
                                <li >
                                    <a href="../../other/error_code/">错误码</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../other/data_safety/">数据安全</a>
                                </li>
							
                            
                                <li >
                                    <a href="../../other/bql/">BQL</a>
                                </li>
							
                        </ul>
                    </li>
                
              </li>
            
              <li>
                  <a href="https://www.bmob.cn/repository/index" target="_blank">知识库</a>
              </li>
              <li>
                  <a href="https://www.bmob.cn/downloads" target="_blank">下载</a>
              </li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> 搜索
                    </a>
                </li>

              <!---->
                <!---->
                    <!--<li >-->
                        <!--<a rel="next" href="../javascript/">-->
                            <!--<i class="fa fa-arrow-left"></i> Previous-->
                        <!--</a>-->
                    <!--</li>-->
                    <!--<li >-->
                        <!--<a rel="prev" href="../restful/">-->
                            <!--Next <i class="fa fa-arrow-right"></i>-->
                        <!--</a>-->
                    <!--</li>-->
                <!---->
              <!---->

              <!---->
                <!---->
                    <!--<li>-->
                        <!--<a href="https://github.com/bmob/bmobdocs/edit/master/docs/push/php/index.md">-->
                            <!---->
                                <!--<i class="fa fa-github"></i> Edit on GitHub-->
                            <!---->
                        <!--</a>-->
                    <!--</li>-->
                <!---->
              <!---->
            </ul>
        </div>
    </div>
</div>
        <div class="pagebody">
                <div class="sidebar">
                    <div class="bs-sidebar hidden-print affix well" role="complementary">

	
		
	
		
				
				
				
				
				
				
				
				
				
		
	
		
				
				
				
				
				
				
				
				
		
	
		
				
				
				
		
	
		
				
				
				
				
				
		
	
		
				
				
		
	
		
				
				
				
				
					<div class="code-title">PHP</div>
				
				
		
	
		
				
				
				
				
		
	


	<ul class="nav bs-sidenav">
		
			
		
			
		
			
		
			
		
			
		
			
		
			
				
					
						
					
						
					
						
					
						
							
								
									<li class="active">
										<a class="itm-l1" href="./">开发文档</a>
										
										<ul class="nav">
											
											<li class="active "><a href="#_1">消息推送简介</a>
												
											</li>
												
											<li class=""><a href="#_2">安装消息推送服务</a>
												
											</li>
												
											<li class=""><a href="#installation">保存 installation</a>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#iosdevicetoken">保存iOS设备的deviceToken</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#android-installationid">保存Android设备的 installationId</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#windows-phone-notificationuri">保存Windows Phone设备的 notificationUri</a></li>
												</ul>
												
											</li>
												
											<li class=""><a href="#_3">订阅频道和退订</a>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_4">订阅频道</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_5">退订频道</a></li>
												</ul>
												
											</li>
												
											<li class=""><a href="#_6">广播推送消息</a>
												
											</li>
												
											<li class=""><a href="#_7">组播推送消息</a>
												
											</li>
												
											<li class=""><a href="#_8">多播推送消息</a>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_9">推送给不活跃的用户</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_10">根据查询条件做推送</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_11">根据平台做推送</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_12">根据地理信息位置做推送</a></li>
												</ul>
												
											</li>
												
											<li class=""><a href="#_13">点播推送消息</a>
												
											</li>
												
											<li class=""><a href="#_14">发送选项设置</a>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_15">定制你的通知</a></li>
												</ul>
												
												<ul class="nav nav-l2">
													<li><a class="itm-l2" href="#_16">设置消息过期时间</a></li>
												</ul>
												
											</li>
												
										</ul>
										
									</li>
								
							
						
					
						
					
				
			
		
			
		
	</ul>
</div>
                </div>
                <div class="content" role="main">
                    <div class="wrap">
                        

<h2 id="_1">消息推送简介</h2>
<p>推送通知是让用户及时被通知、和你的应用保持联系的一种非常棒的方式，你可以快速而有效地通知到所有的用户，下面这个教程将会教你如何使用Bmob来推送消息。</p>
<h2 id="_2">安装消息推送服务</h2>
<p>每一个Bmob的App被安装在用户的设备上后，如果要使用消息推送功能，Bmob SDK会自动生成一个Installation对象。Installation对象包含了推送所需要的所有信息。举例：一个棒球的App，你可以让用户订阅感兴趣的棒球队，然后及时将这个球队的消息推送给用户 。
你可以使用 REST API，通过请求URL <strong>/1/installations</strong> 对Installation对象进行一系列操作，就像你存储和获取其他的普通对象，如GameScore对象一样。
注意Installation对象一般只在Client SDK中进行修改，但REST API对于大量导入或导出订阅数据的Installation对象是极其有用的。</p>
<p>Installation对象有几个系统默认的特殊字段来帮助你进行定位到设备等管理：
- <strong>badge</strong> : iOS应用中右上角的图标标识，这不会在服务端进行自增，需要开发者自己实现自增统计
- <strong>channels</strong> : 当前这个设备订阅的渠道名称数组
- <strong>timeZone</strong> : 设备所在位置的时区， 如Asia/Shanghai，这个会在每个Installation对象更新时同步（只读）
- <strong>deviceType</strong> : 设备的类型, 值为："ios" 或 "android" (只读)
- <strong>installationId</strong> : Bmob使用的设备唯一号，Android设备是必须的，iOS可选 (只读)
- <strong>deviceToken</strong> : iOS设备由Apple APNS生成的唯一性token标识 (只读)
- <strong>notificationUri</strong> : Windows Phone设备由Windows Push Center生成的唯一性token标识</p>
<h2 id="installation">保存 installation</h2>
<h3 id="iosdevicetoken">保存iOS设备的deviceToken</h3>
<p>iOS设备通常使用deviceToken来对一台设备进行惟一标识。</p>
<pre><code>$bmobPush = new BmobPush();
$data=array(    
    &quot;deviceType&quot;=&gt;&quot;ios&quot;,
    &quot;deviceToken&quot;=&gt;&quot;abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789&quot;,
    &quot;channels&quot;=&gt;array(&quot;Giants&quot;)
);
$res = $bmobPush-&gt;addInstallations($data);

</code></pre>

<h3 id="android-installationid">保存Android设备的 installationId</h3>
<p>对于Android设备，<a href="http://www.bmob.cn/" title="Bmob移动后端云服务平台">Bmob</a>SDK会自动生成uuid作为installationId保存到 Bmob。 你可以使用以下REST API保存Android设备的installation ID。</p>
<pre><code>
$bmobPush = new BmobPush();
$data=array(    
    &quot;deviceType&quot;=&gt;&quot;android&quot;,
    &quot;installationId&quot;=&gt;&quot;12345678-4312-1234-1234-1234567890ab&quot;,
    &quot;channels&quot;=&gt;array(&quot;Giants&quot;)
);
$res = $bmobPush-&gt;addInstallations($data);

</code></pre>

<p>你还可以更新Installation对象的更多属性，用来查询installationId，定制更通用的推送</p>
<pre><code>$res = $bmobPush-&gt;updateInstallations(&quot;fdcc6a94c6&quot;,array(&quot;injuryReports&quot;=&gt;true)); //更新设备表

</code></pre>

<h3 id="windows-phone-notificationuri">保存Windows Phone设备的 notificationUri</h3>
<p>对于Windows Phone设备，<a href="http://www.bmob.cn/" title="Bmob移动后端云服务平台">Bmob</a>SDK会自动从Windows Push Center获取到notificationUri并保存到 Bmob。 你可以使用以下php sdk保存Windows Phone设备的notificationUri。</p>
<pre><code>$data=array(    
    &quot;deviceType&quot;=&gt;&quot;windows phone&quot;,
    &quot;notificationUri&quot;=&gt;&quot;https://hk1.notify.live.net/unthrottledthirdparty/01.00/AQHgHh6EuwNtTa1TbwvaAjnmAgAAAAADEAAAAAQUZm52OkZDM0U5RDkxQzIzREJBNDYFBkFTRUEwMQ&quot;,
    &quot;channels&quot;=&gt;array(&quot;Giants&quot;)
);
    $res = $bmobPush-&gt;addInstallations($data);
</code></pre>

<h2 id="_3">订阅频道和退订</h2>
<h3 id="_4">订阅频道</h3>
<p>覆盖已订阅的频道：</p>
<pre><code>$res = $bmobPush-&gt;updateInstallations(&quot;fdcc6a94c6&quot;,array(&quot;channels&quot;=&gt;array(&quot;Giants&quot;)))
</code></pre>

<p>订阅一个新频道，不覆盖已订阅的频道：</p>
<pre><code>$data = array(
    &quot;channels&quot;=&gt;array(
        &quot;__op&quot;=&gt;&quot;AddUnique&quot;,
        &quot;objects&quot;=&gt;array(&quot;Giants&quot;),
    )
);
$res = $bmobPush-&gt;updateInstallations(&quot;fdcc6a94c6&quot;, $data);
</code></pre>

<h3 id="_5">退订频道</h3>
<pre><code>$data = array(
    &quot;channels&quot;=&gt;array(
        &quot;__op&quot;=&gt;&quot;Remove&quot;,
        &quot;objects&quot;=&gt;array(&quot;Giants&quot;),
    )
);
$res = $bmobPush-&gt;updateInstallations(&quot;fdcc6a94c6&quot;, $data);
</code></pre>

<h2 id="_6">广播推送消息</h2>
<pre><code>$res = $bmobPush-&gt;push(array(&quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;))); 
</code></pre>

<h2 id="_7">组播推送消息</h2>
<p>发送给订阅了Giants频道的用户</p>
<pre><code> $res = $bmobPush-&gt;push(array(&quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),&quot;where&quot;=&gt;array(&quot;channels&quot;=&gt;array(&quot;Giants&quot;)))); 
</code></pre>

<p>或者更简便的方式</p>
<pre><code>$res = $bmobPush-&gt;push(array(&quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),&quot;channels&quot;=&gt;array(&quot;Giants&quot;))); 
</code></pre>

<h2 id="_8">多播推送消息</h2>
<h3 id="_9">推送给不活跃的用户</h3>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),
    &quot;where&quot;=&gt;array(&quot;updatedAt&quot;=&gt;array(
                &quot;$lt&quot;=&gt;array(&quot;__type&quot;=&gt;&quot;Date&quot;,&quot;iso&quot;=&gt;&quot;2012-01-29 11:33:53&quot;))
             )
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<h3 id="_10">根据查询条件做推送</h3>
<pre><code>$res = $bmobPush-&gt;push(array(&quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),&quot;where&quot;=&gt;array(&quot;scores&quot;=&gt;true))); 
</code></pre>

<p>请注意，where 条件查询的都是 installations 表。这里是假设 installations 表存储了 scores 的布尔属性，你可以像查询普通对象一样构造where查询</p>
<h3 id="_11">根据平台做推送</h3>
<pre><code>$res = $bmobPush-&gt;push(array(&quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),&quot;where&quot;=&gt;array(&quot;deviceType&quot;=&gt;&quot;android&quot;))); 
</code></pre>

<pre><code>$res = $bmobPush-&gt;push(array(&quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),&quot;where&quot;=&gt;array(&quot;deviceType&quot;=&gt;&quot;ios&quot;))); 
</code></pre>

<p>Windows Phone平台的推送分三种格式：</p>
<p>a.推送Raw通知(<strong>默认</strong>)：</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;, &quot;wpAlert&quot;=&gt;&quot;TextBoxValue2&quot;),
    &quot;where&quot;=&gt;array(&quot;deviceType&quot;=&gt;&quot;windows phone&quot;)
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<p>b.推送Toast通知：</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;,
                  &quot;wpAlert&quot;=&gt;&quot;TextBoxValue2&quot;,
                   &quot;wp&quot;=&gt; 2),
    &quot;where&quot;=&gt;array(&quot;deviceType&quot;=&gt;&quot;windows phone&quot;)
);

$res = $bmobPush-&gt;push($data); 

</code></pre>

<p>c.推送磁贴通知：</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;,
                  &quot;backgroundImage&quot;=&gt;&quot;backgroundImage&quot;,
                  &quot;count&quot;=&gt; 2,
                  &quot;backBackgroundImage&quot;=&gt;&quot;backBackgroundImage&quot;,             
                  &quot;backTitle&quot;=&gt;&quot;backTitle&quot;,
                  &quot;backContent&quot;=&gt;&quot;backContent&quot;,
                  &quot;wp&quot;=&gt;1,
                ),
    &quot;where&quot;=&gt;array(&quot;deviceType&quot;=&gt;&quot;windows phone&quot;)
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<h3 id="_12">根据地理信息位置做推送</h3>
<pre><code>
$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),
    &quot;where&quot;=&gt;array(&quot;user&quot;=&gt;array(
                             &quot;$inQuery&quot;=&gt;array(
                                    &quot;location&quot;=&gt;array(&quot;$nearSphere&quot;=&gt;array(
                                                                                                                                                                &quot;__type&quot;=&gt;&quot;GeoPoint&quot;,
                                                            &quot;latitude&quot;=&gt;30.0,
                                                            &quot;longitude&quot;=&gt;-20.0,
                                                                                ),
                                                     &quot;$maxDistanceInMiles&quot;=&gt;1.0
                                                    )
                                    )
                           )
                   )
);

$res = $bmobPush-&gt;push($data); 

</code></pre>

<p>上面的例子假设 installation 有个 user 属性指向_User 表的记录，并且用户有个 location 属性是 GeoPoint 类型，我们就可以根据地理信息位置做推送。</p>
<h2 id="_13">点播推送消息</h2>
<p>发送给Android单个客户端</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;hello&quot;),
    &quot;where&quot;=&gt;array(&quot;installationId&quot;=&gt;&quot;57234d4c-752f-4e78-81ad-a6d14048020d&quot;)
);

$res = $bmobPush-&gt;push($data); 

</code></pre>

<p>发送给iOS单个客户端</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;aps&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;cashi&quot;,&quot;badge&quot;=&gt;1,&quot;sound&quot;=&gt;&quot;default&quot;)),
    &quot;where&quot;=&gt;array(&quot;deviceToken&quot;=&gt;&quot;abcdef0123456789abcdef0123456789abcdef0123456789abcdef012345678&quot;)
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<p>发送给Windows Phone单个客户端Toast通知</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;cashi&quot;,&quot;wpAlert&quot;=&gt;&quot;bmob&quot;,&quot;wp&quot;=&gt;2),
    &quot;where&quot;=&gt;array(&quot;notificationUri&quot;=&gt;&quot;https://hk1.notify.live.net/unthrottledthirdparty/01.00/AQHgHh6EuwNtTa1TbwvaAjnmAgAAAAADEAAAAAQUZm52OkZDM0U5RDkxQzIzREJBNDYFBkFTRUEwMQ&quot;)
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<h2 id="_14">发送选项设置</h2>
<p>推送通知不仅仅可以用来发送消息，iOS中，推送内容还可以包含要播放的声音和要显示的badge数字值,还可以定制任何你想发送的内容，对于Android，你甚至可以指定Intent应用于接收消息，对于时效有要求的消息你还可以设置一个消息过期时间。</p>
<h3 id="_15">定制你的通知</h3>
<p>如果你想发送更多的消息，你可以在data的字典对象中设置其他字段，下面这些保留的字段有其特殊的意义：
- <strong>alert</strong> : 通知的消息内容
- <strong>badge</strong> : (仅iOS)一个数字值将会高亮显示在应用图标的右上角。
- <strong>sound</strong> : (仅iOS)应用绑定包中的声音
- <strong>content-available</strong> : (仅iOS)如果你的应用是新闻类的，或者你的应用正在使用iOS7的Remote Notification Background Mode，设定这个值为1将会触发离线下载功能。
- <strong>action</strong> : (仅Android)接收到推送消息时应用Intent，如果没有指定title或alert，Intent将被应用，但是没有通知呈现给用户。
- <strong>title</strong> : (仅Android)这个值将显示在系统通知栏
- <strong>wp</strong> : (仅Windows Phone)通知类型 0-Raw(默认) 1-Toast 2-磁贴
- <strong>wpAlert</strong> : (仅Windows Phone)这个值将在Raw 和 Toast两种通知中有用，相对alert，作为子标题
- <strong>backgroundImage</strong> : (仅Windows Phone)通知类型wp=2，磁贴类通知中有用
- <strong>count</strong> : (仅Windows Phone)通知类型wp=2，磁贴类通知中有用
- <strong>backBackgroundImage</strong> : (仅Windows Phone)通知类型wp=2，磁贴类通知中有用
- <strong>backTitle</strong> : (仅Windows Phone)通知类型wp=2，磁贴类通知中有用
- <strong>backContent</strong> : (仅Windows Phone)通知类型wp=2，磁贴类通知中有用</p>
<p>例如，推送一条通知，将当前的badge值设置为一个数字值,并且播放iOS设备上定制的音乐，对于Android用户，将在系统通知栏中显示特殊的标题，其请求如下：</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;cashi&quot;,&quot;badge&quot;=&gt;10,&quot;sound&quot;=&gt;&quot;cheering.caf&quot;,&quot;title&quot;=&gt;&quot;Mets Score!&quot;),
    &quot;channels&quot;=&gt;array(&quot;Mets&quot;)
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<p>当然，你也可以在data字典对象中定制自己的字段来推送消息，但推送到消息不显示在 Andoid 系统的通知栏中，而是执行应用程序预定义的逻辑，Android或iOS的接收消息文档中对此有说明，iOS只有当用户从通知中打开应用，才能访问data的数据，Android将提供这个数据在action Intent应用之后将提供这个数据,</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;cashi&quot;,&quot;action&quot;=&gt;&quot;com.example.UPDATE_STATUS&quot;,&quot;name&quot;=&gt;&quot;Vaughn&quot;),
    &quot;channels&quot;=&gt;array(&quot;Mets&quot;)
);

$res = $bmobPush-&gt;push($data); 

</code></pre>

<h3 id="_16">设置消息过期时间</h3>
<p>过期时间，可以是绝对时间：</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;cashi&quot;),
    &quot;expiration_time&quot;=&gt;&quot;2013-12-04 00:51:13&quot;
);

$res = $bmobPush-&gt;push($data); 
</code></pre>

<p>也可以是相对时间（根据push_time做定期推送，从push_time时间开始算起，直到expiration_interval时间后过期），下面的请求表示消息将在2012-01-28 00:51:13这个时间点开始推送，直到7天后过期:</p>
<pre><code>$data = array(
    &quot;data&quot;=&gt;array(&quot;alert&quot;=&gt;&quot;cashi&quot;),
    &quot;push_time&quot;=&gt;&quot;2012-01-28 00:51:13&quot;,
    &quot;expiration_interval&quot;=&gt;518400,
);

$res = $bmobPush-&gt;push($data); 
</code></pre>
                    </div>
                </div>
        </div>

        <footer class="col-md-12">
                <p>Copyright © 2017 Bmob, Maintained by the Bmob Support.</p>
            <!--<p>Copyright © 2017 Bmob, Maintained by the Bmob Support.</p>-->
        </footer>
        <script>var base_url = '../..';</script>
        <script src="../../js/base.js"></script>
        <script src="../../search/require.js"></script>
        <script src="../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">搜索</h4>
            </div>
            <div class="modal-body">
                <p>
                    请输入您要搜索的内容
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    <div id="go-top"><i class="fa fa-chevron-up"></i></div>
    <a href="https://docs.bmob.cn/data/Android/a_faststart/doc/index.html" id="back" target="_blank">返回 <br> 旧版</a>


    </body>
</html>
